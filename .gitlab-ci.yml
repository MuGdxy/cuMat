image: nvidia/cuda:9.0-devel

stages:
 - prepare
 - docs
 - test
 
prepare:
  stage: prepare
  script:
  - apt-get update && apt-get install -y --no-install-recommends cmake doxygen
  - mkdir build
  - cd build/
  - cmake ..
  artifacts:
    paths:
    - build

docs:
  stage: docs
  script:
  - apt-get update && apt-get install -y --no-install-recommends doxygen
  - doxygen build/docs/Doxyfile
  - mv build/docs/doc_doxygen/html/ public/
  artifacts:
    paths:
    - public
  only:
  - master

test:
  stage: test
  script:
  - cd build/
  - make